/**
 * 
 */
package RobotWarsGregoryHarman;

import java.util.Scanner;

/**
 * @author Gregory Harman
 *
 */
public class RobotWarsApp {

	int fightsCount = 0;
	int totalPowerHumans = 0;
	int totalPowerRobots = 0;

	int humansKilled = 0;
	int robotsKilled = 0;
	int uniqueIDNum = 0;

	int humanWins = 0;
	int robotWins = 0;
	int draws = 0;

	boolean humanWinner = false;
	boolean robotWinner = false;



	public static void main(String[] args) {

		RobotWarsApp robotWars = new RobotWarsApp();

		robotWars.runProgram();
	}

	public void runProgram() {

		boolean quit = false;

		System.out.println("Welcome to Robot Wars.");

		//menu loop
		do{
			System.out.println("\nPlease pick an option.");
			System.out.println("1) Play One vs One.");
			System.out.println("2) Play last stand.");
			System.out.println("3) Quit.");

			Scanner scan = new Scanner(System.in);

			String input = scan.nextLine();

			switch(input){

			case "1":	gameModeOneVSOne(); break;

			case "2":   gameModeLastStand(); break;

			case "3": quit = true; 										//quit game
			System.out.println("Thank you for playing, Good bye."); 
			break;

			default : System.out.println("Please enter a correct option (1-3): "); //if incorrect number inputed loop back

			}

		}while(!quit);

	}

	private void gameModeOneVSOne() {

		Humans human = new Humans(0);
		Robots robot = new Robots(0);

		//loop till 500 humans have fought 500 robots
		while(fightsCount < 500){

			//create a new human and robot
			human = new Humans(uniqueIDNum);	
			robot = new Robots(uniqueIDNum);

			++uniqueIDNum; //increases the number to be used as a unique ID
			++fightsCount; // counts how many fights there has been so far

			//gets the opponents power
			double humanPower = human.getPower(); 
			double robotPower = robot.getPower();

			//adds power to total
			totalPowerHumans += humanPower;
			totalPowerRobots += robotPower;

			//prints out each fighters details
			fightersDetails(human,robot);

			//finds the winner
			getFightWinner(humanPower,robotPower,human,robot);

		}

		System.out.println("The war has ended.");
		System.out.println("The results of this one vs one game: ");

		getBattleResults(); //print results of the battle

		resetVariables(); //resets all variables

	}	

	private void gameModeLastStand() {

		Humans human = new Humans(0);
		Robots robot = new Robots(0);

		//loop till 500 humans or 500 robots are all killed
		while((humansKilled < 500 && robotsKilled < 500)){

			if(humanWinner){ //if human was the last winner reduce their power and make a new robot
				human.setReducedPower();	
				robot = new Robots(uniqueIDNum);
			}else if(robotWinner){ //if robot was the last winner reduce their power and make a new human
				robot.setReducedPower();
				human = new Humans(uniqueIDNum);
			}else{								//if a draw make new human and robot
				human = new Humans(uniqueIDNum);
				robot = new Robots(uniqueIDNum);
			}

			++uniqueIDNum; //increases num to be used as a unique ID
			++fightsCount; // counts how many fights there has been



			double humanPower = human.getPower();
			double robotPower = robot.getPower();

			//gets the opponents power
			totalPowerHumans += humanPower;
			totalPowerRobots += robotPower;

			//prints out each fighters details
			fightersDetails(human,robot);

			//finds the winner
			getFightWinner(humanPower,robotPower,human,robot);


		}

		System.out.println("The war has ended.");
		System.out.println("The results of this last stand game: ");	
		
		getBattleResults(); //print results of the battle
		resetVariables(); //resets all variables

	}

	private void fightersDetails(Humans human, Robots robot) {
		System.out.println("Fight number: " + fightsCount);

		System.out.println("Fighting for the humans we have -\n" + human.getName() + ". Dog Tag Number: " + human.getUniqueID() 
		+ ". Their Strength is " + human.getPower() + ".");

		System.out.println("In this corner fighting for the robots we have -\nA " + robot.getModelName() + " Killbot. Serial Number: " 
				+ robot.getUniqueID() + ". Its Strength is " + robot.getPower() + ".");

	}

	private void getBattleResults() {

		System.out.println("They had a total of " + fightsCount + " fights.");

		System.out.println("The humans had a total power of " + totalPowerHumans + " and won " + humanWins + " fights, and had " 
				+ draws + " draws. They lost " + humansKilled + " people.");

		System.out.println("The robots had a total power of " + totalPowerRobots + " and won " + robotWins + " fights, and had " 
				+ draws + " draws. They lost " + robotsKilled + " combat units.");


		if(totalPowerHumans > totalPowerRobots){

			System.out.println("The humans have won the war and defeated the robot menace! (unless the robots figure out time travel)\n");

		}else if(totalPowerRobots > totalPowerHumans){

			System.out.println("The robots have won the war, the humans are dead, they killed their ass's with poisonious gases.\n");

		}else{
			System.out.println("The war is a draw, both forces have destroyed each other.\n");
		}



	}

	private void resetVariables(){
		fightsCount = 0;
		totalPowerHumans = 0;
		totalPowerRobots = 0;

		humansKilled = 0;
		robotsKilled = 0;
		uniqueIDNum = 0;

		humanWins = 0;
		robotWins = 0;
		draws = 0;

		humanWinner = false;
		robotWinner = false;
	}

	private void getFightWinner(double humanPower,double robotPower, Humans human, Robots robot ){

		if(humanPower > robotPower){
			++humanWins; 
			humanWinner = true;
			robotWinner = false;
			++robotsKilled;
			System.out.println("\nThe human " + human.getName() + " wins!!!.");
			System.out.println("Robots killed so far: " + robotsKilled + ". Humans killed so far: " + humansKilled + ".\n");


		}else if(robotPower > humanPower){
			++robotWins;
			robotWinner = true;
			humanWinner = false;
			++humansKilled;
			System.out.println("\nKillbot " + robot.getModelName() + " wins!!!.");
			System.out.println("Robots killed so far: " + robotsKilled + ". Humans killed so far: " + humansKilled + ".\n");


		}else{
			++draws;
			robotWinner = false;
			humanWinner = false;
			++humansKilled;
			++robotsKilled;
			System.out.println("The combatants have killed each other and drawn.\n");
		}
	}

}
